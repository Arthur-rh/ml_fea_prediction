# Script to analyze the dataset, durations of penetration sequences and timesteps
# generated by ChatGPT for the most part

import pandas as pd

# --- Load your dataset ---
df = pd.read_csv("Finite_element_entire_data_set.csv")

# --- Define the grouping keys used to build sequences ---
GROUP_COLS = ["Velocity", "Projectile", "Angle", "Laminate"]

# Store sequence lengths and durations
seq_lengths = []
seq_durations = []

problems = []

grouped = df.groupby(GROUP_COLS)

for key, group in grouped:
    group_sorted = group.sort_values("Time")
    
    # Number of timesteps
    length = len(group_sorted)
    seq_lengths.append(length)
    
    # Duration = max(Time) - min(Time)
    duration = group_sorted["Time"].max() - group_sorted["Time"].min()
    seq_durations.append(duration)
    
    # Store group info if something is weird
    problems.append((key, length, duration))

# --- Check if all durations are identical ---
all_equal_duration = len(set([round(d, 12) for d in seq_durations])) == 1

# --- Check if all sequence lengths are identical ---
all_equal_length = len(set(seq_lengths)) == 1

print("=== SEQUENCE CHECK ===")
print(f"Number of unique sequences: {len(seq_lengths)}")

print("\nDurations:")
print(f" - Unique durations: {set([round(d, 12) for d in seq_durations])}")
print(f" - All sequences have equal duration? {all_equal_duration}")

print("\nTimesteps:")
print(f" - Unique sequence lengths: {set(seq_lengths)}")
print(f" - All sequences have equal length? {all_equal_length}")

# Extra: print problematic groups if needed
if not all_equal_duration or not all_equal_length:
    print("\n=== Groups with inconsistencies ===")
    for key, length, duration in problems:
        print(f"{key} --> length={length}, duration={duration}")
